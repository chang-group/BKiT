<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta name="description" content="">
        <meta name="author" content="">
        <link rel="icon" href="../../../../favicon.ico">
    
        <!-- <title>BKit</title> -->
        <link rel="icon" href="Fig/logo.png" type="image/x-icon">
    
        <!-- Bootstrap core CSS -->
        <link href="https://getbootstrap.com/docs/4.1/dist/css/bootstrap.min.css" rel="stylesheet">
    
        <!-- Custom styles for this template -->
        <link href="css/tmp.css" rel="stylesheet">
    
        <script src="js/highlight.pack.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>

        <script type="text/x-mathjax-config">
            MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
        </script>
        <script type="text/javascript"
		    src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
	    </script>
    </head>

  <body>

    <nav class="navbar navbar-expand-md navbar-dark bg-dark fixed-top">
        <a class="navbar-brand" href="https://github.com/truzmeto/BKit">GitHub</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
          <div class="collapse navbar-collapse" id="navbarsExampleDefault">
          <ul class="navbar-nav mr-auto">
              <li class="nav-item">
                  <a class="nav-link" href="index.html">Home<span class="sr-only"></span></a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="UnbindingPath.html">Chapter 1<span class="sr-only"></span></a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="Milestones.html">Chapter 2<span class="sr-only"></span></a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="ShortMDs.html">Chapter 3<span class="sr-only"></span></a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="Kinetics.html">Chapter 4<span class="sr-only"></span></a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="FreeEnergy.html">Chapter 5<span class="sr-only"></span></a>
              </li>          
          </ul>
          </div>
      </nav>
    
<main role="main" class="container-fluid">
    <div class="starter-template">
        <h1>Dissociation Path Construction</h1>
        <a href="https://github.com/truzmeto/BKit/blob/main/BKit/SmoothPath.py"><h3>Code</h3></a>
    </div>
    <div class="container-fluid">
        <div class="row">
            <div class="col-sm">
                <h2>Introduction</h2> 
                <p>Important elements that contribute to protein ligand dissociation free energy are
                intra and intermolecular interactions, conformational rearrengments and concentric motions.
                Reaction coordinates such as center of mass separation distance $R_{CM}$ or fraction of native 
                contacts are incapable of capturing these effects. Thus we use all atom positions, compressed with PCA
                to preserve variance, and use reduced dimention to build unbinding path. Unbinding transition path
                construction is an essential initial step in this pipline. Here, we represent every frame of
                MD trajectory in a reduced 3D PCA space(<b>Figure 1</b>)</p>. 
            </div>
            <div class="col-sm">
                <img src="Fig/PL1.gif" mode=loop class="rounded mx-auto d-block float-center" alt="" width=60%>
                <h6>Figure 1: Unbinding transiton visualization for CDK8-PL1 complex.</h6>
            </div>            
        </div>
        <div class="row">
            <div class="col-sm">
                <h2>MD Trajectories to Principal Components </h2>
                <p> Here we select backbone $C_{\alpha}$ atom positions of protein and all heavy atoms of ligand to use as
                our collective variables. 3N number of variables are linearly transformed into PCA space and we only keep 3 components
                that preserve maximal amount of variance.
                (<b>Figure 2</b>).</p>                               
            </div>
            <div class="col">
                <img src="Fig/PL13D_unbinding_raw.png" class="rounded mx-auto d-block float-center" alt="Dataset sample" width=80%>
                <h6>Figure 2: Dissociation trajectories projected into PCA space illustrated, where from dark blue to bright yellow transformation
                represents unbinding. </h6>
            </div>
            
        </div>
        <div class="row">
            <div class="col-sm">
                <h2>Smooth path with simple moving average</h2>
                Approaching this problem we looked at sevaral papers, that developed SE(3) equivariant models: 
                <ul>
                <li>Cormorant : Covariant Molecular Neural Networks <b>[1]</b></li>
                <li>Tensor field networks: Rotation- and translation-equivariant neural networks for 3D point clouds <b>[2]</b></li>
                <li>Equivariant Attention Networks <b>[3]</b></li>
                </ul>
                <p>The Cormorant networks seemed to fit perfectly for this problem and it also was published before the recent CASP experiment, however 
                authors noted that the training procedure was unstable after 5-6 layers. Meanwhile according to DeepMind presentation AlphaFold2 has 
                ~50 layers in the structural part of the model.</p>
                </p>
            </div>
            <div class="col">
                <img src="Fig/SE3Transformer.png" class="rounded mx-auto d-block float-center" alt="Training process" width=80%>
                <h6>Figure 3. Schematic workflow of SE(3) transformer.</h6>
            </div>
            
        </div>
        <div class="row">
            <div class="col-sm">
                <h2>Random path generation with KDTree</h2>
                <p>We can rewrite tesseral spherical harmonics in the following way:
                $$Y_{lm}(\theta, \phi) = \sum_{k=m}^{l} B(k,l,m) \left(1-cos^2(\theta)\right)^{\frac{m}{2}} cos^{k-m}(\theta) sin(m\phi)$$
                where coefficients $B(k,l,m)$ do not depend on the angles $\theta$ and $\phi$ and can be precomputed before training. </p>
                <p>To compute the harmonics with precomputed coefficients $B$ we compute tensors that depend on the angles, multiply them by the coefficients $B$
                    and sum over the index $k$ (<b>Figure 4</b>).</p>
            </div>
            <div class="col">
                <br><br><br><br>
                <img src="Fig/SphericalHarmonics.png" class="rounded mx-auto d-block float-center" alt="Training process" width=80%>
                <h5>Figure 4: Computing sherical harmonics with the precomputed coefficients $B(k,l,m)$.</h5>
                <br><br>
            </div>
            
        </div>
        <div class="row">
            <div class="col-sm">
                <h2>Removing sharp corners</h2>
                <p>Now, with fully differentiable basic building blocks we can finally build a model, that will predict coordinates of particles 10 timesteps 
                ito the future. However, we have to take into accout that SE(3) transformer deals with vector fields and node coordinates are a set of three
                scalar fields. Therefor we instead predict displacement of each node compared to the previous iteration of the model.</p>
               </div>
            <div class="col">
                <img src="Fig/SE3TransformerModel.png" class="rounded mx-auto d-block float-center" alt="Training process" width=80%>
                <h5>Figure 5: Iterative SE(3) transformer model.</h5>
            </div>
        </div>
     
    </div><!-- /.container -->
</main>

<!-- Bootstrap core JavaScript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script>window.jQuery || document.write('<script src="https://getbootstrap.com/docs/4.1/assets/js/vendor/jquery-slim.min.js"><\/script>')</script>
<script src="https://getbootstrap.com/docs/4.1/assets/js/vendor/popper.min.js"></script>
<script src="https://getbootstrap.com/docs/4.1/dist/js/bootstrap.min.js"></script>
</body>
</html>